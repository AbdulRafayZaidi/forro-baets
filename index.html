<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForrÃ³ Step Master</title>
    <style>
        :root { --q-color: #ff4757; --s-color: #2ed573; --bg: #2f3542; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .card { background: #3f4452; padding: 2rem; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); text-align: center; width: 350px; }
        
        /* The Visualizer */
        #display { 
            width: 100%; height: 120px; border-radius: 10px; background: #2f3542;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin: 20px 0; border: 4px solid #57606f; transition: all 0.1s;
        }
        #step-text { font-size: 1.8rem; font-weight: bold; text-transform: uppercase; }
        #foot-text { font-size: 1rem; color: #ced6e0; margin-top: 5px; }

        .pulse-q { background: var(--q-color) !important; border-color: white !important; transform: scale(1.02); }
        .pulse-s { background: var(--s-color) !important; border-color: white !important; transform: scale(1.05); }

        button { background: #1e90ff; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; font-size: 1.1rem; }
        .stop-mode { background: #ff4757; }
        
        input[type="range"] { width: 100%; margin: 15px 0; }
        .upload-area { margin-top: 20px; border-top: 1px solid #57606f; padding-top: 20px; font-size: 0.9rem; }
        audio { width: 100%; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="card">
        <h2 style="margin:0">ðŸª— ForrÃ³ Step Master</h2>
        <p style="font-size: 0.8rem; opacity: 0.7;">Quick-Quick-Slow Trainer</p>
        
        <div id="display">
            <div id="step-text">READY?</div>
            <div id="foot-text">Press Start</div>
        </div>

        <label>BPM: <span id="bpmVal">80</span></label>
        <input type="range" id="bpmRange" min="60" max="140" value="80">

        <button id="startBtn">START PRACTICE</button>

        <div class="upload-area">
            <label>Practice with your music:</label><br>
            <input type="file" id="audioUpload" accept="audio/*">
            <audio id="audioPlayer" controls></audio>
        </div>
    </div>

    <script>
        let audioCtx = null;
        let isRunning = false;
        let timerID = null;
        let nextNoteTime = 0.0;
        let stepIdx = 0;

        // The ForrÃ³ "Quick
